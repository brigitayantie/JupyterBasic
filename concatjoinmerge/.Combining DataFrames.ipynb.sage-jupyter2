{"backend_state":"running","kernel":"python3","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":82001920},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.3"}},"type":"settings"}
{"cell_type":"code","exec_count":1,"id":"35e164","input":"import seaborn as sns\nimport pandas as pd\nimport numpy as np","pos":0,"type":"cell"}
{"cell_type":"code","exec_count":10,"id":"e4cc6f","input":"# and finally this will add on the dataset where it's from\npd.concat([tips_bill, tips_tip], sort=False, keys=['num0', 'num1'])","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th></th>\n      <th>total_bill</th>\n      <th>tip</th>\n    </tr>\n    <tr>\n      <th></th>\n      <th>sex</th>\n      <th>smoker</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"4\" valign=\"top\">num0</th>\n      <th rowspan=\"2\" valign=\"top\">Male</th>\n      <th>Yes</th>\n      <td>1337.07</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>1919.75</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Female</th>\n      <th>Yes</th>\n      <td>593.27</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>977.68</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th rowspan=\"4\" valign=\"top\">num1</th>\n      <th rowspan=\"2\" valign=\"top\">Male</th>\n      <th>Yes</th>\n      <td>NaN</td>\n      <td>183.07</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>NaN</td>\n      <td>302.00</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Female</th>\n      <th>Yes</th>\n      <td>NaN</td>\n      <td>96.74</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>NaN</td>\n      <td>149.77</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"                    total_bill     tip\n     sex    smoker                    \nnum0 Male   Yes        1337.07     NaN\n            No         1919.75     NaN\n     Female Yes         593.27     NaN\n            No          977.68     NaN\nnum1 Male   Yes            NaN  183.07\n            No             NaN  302.00\n     Female Yes            NaN   96.74\n            No             NaN  149.77"},"exec_count":10,"output_type":"execute_result"}},"pos":24,"type":"cell"}
{"cell_type":"code","exec_count":18,"id":"07f548","input":"tips_tip","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>tip</th>\n    </tr>\n    <tr>\n      <th>sex</th>\n      <th>smoker</th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Male</th>\n      <th>Yes</th>\n      <td>183.07</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>302.00</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Female</th>\n      <th>Yes</th>\n      <td>96.74</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>149.77</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"                  tip\nsex    smoker        \nMale   Yes     183.07\n       No      302.00\nFemale Yes      96.74\n       No      149.77"},"exec_count":18,"output_type":"execute_result"}},"pos":6,"type":"cell"}
{"cell_type":"code","exec_count":2,"id":"d39479","input":"tips = sns.load_dataset('tips')\ntips.head(3)","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>total_bill</th>\n      <th>tip</th>\n      <th>sex</th>\n      <th>smoker</th>\n      <th>day</th>\n      <th>time</th>\n      <th>size</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>16.99</td>\n      <td>1.01</td>\n      <td>Female</td>\n      <td>No</td>\n      <td>Sun</td>\n      <td>Dinner</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>10.34</td>\n      <td>1.66</td>\n      <td>Male</td>\n      <td>No</td>\n      <td>Sun</td>\n      <td>Dinner</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>21.01</td>\n      <td>3.50</td>\n      <td>Male</td>\n      <td>No</td>\n      <td>Sun</td>\n      <td>Dinner</td>\n      <td>3</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"   total_bill   tip     sex smoker  day    time  size\n0       16.99  1.01  Female     No  Sun  Dinner     2\n1       10.34  1.66    Male     No  Sun  Dinner     3\n2       21.01  3.50    Male     No  Sun  Dinner     3"},"exec_count":2,"output_type":"execute_result"}},"pos":2,"type":"cell"}
{"cell_type":"code","exec_count":20,"id":"5a4f03","input":"pd.merge?","pos":8,"type":"cell"}
{"cell_type":"code","exec_count":22,"id":"d831bd","input":"# we can merge on the indexes\npd.merge(tips_bill, tips_tip, \n         right_index=True, left_index=True)","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>total_bill</th>\n      <th>tip</th>\n    </tr>\n    <tr>\n      <th>sex</th>\n      <th>smoker</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Male</th>\n      <th>Yes</th>\n      <td>1337.07</td>\n      <td>183.07</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>1919.75</td>\n      <td>302.00</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Female</th>\n      <th>Yes</th>\n      <td>593.27</td>\n      <td>96.74</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>977.68</td>\n      <td>149.77</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"               total_bill     tip\nsex    smoker                    \nMale   Yes        1337.07  183.07\n       No         1919.75  302.00\nFemale Yes         593.27   96.74\n       No          977.68  149.77"},"exec_count":22,"output_type":"execute_result"}},"pos":10,"type":"cell"}
{"cell_type":"code","exec_count":24,"id":"54c5de","input":"#we can reset indexes and then merge on the columns - perhaps the easiest way\npd.merge(\n    tips_bill.reset_index(), \n    tips_tip.reset_index(),\n    on=['sex', 'smoker']\n)","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sex</th>\n      <th>smoker</th>\n      <th>total_bill</th>\n      <th>tip</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Male</td>\n      <td>Yes</td>\n      <td>1337.07</td>\n      <td>183.07</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Male</td>\n      <td>No</td>\n      <td>1919.75</td>\n      <td>302.00</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Female</td>\n      <td>Yes</td>\n      <td>593.27</td>\n      <td>96.74</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Female</td>\n      <td>No</td>\n      <td>977.68</td>\n      <td>149.77</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"      sex smoker  total_bill     tip\n0    Male    Yes     1337.07  183.07\n1    Male     No     1919.75  302.00\n2  Female    Yes      593.27   96.74\n3  Female     No      977.68  149.77"},"exec_count":24,"output_type":"execute_result"}},"pos":11,"type":"cell"}
{"cell_type":"code","exec_count":25,"id":"381910","input":"# it can actually infer the above - but be very careful with this\npd.merge(\n    tips_bill.reset_index(), \n    tips_tip.reset_index()\n)","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sex</th>\n      <th>smoker</th>\n      <th>total_bill</th>\n      <th>tip</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Male</td>\n      <td>Yes</td>\n      <td>1337.07</td>\n      <td>183.07</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Male</td>\n      <td>No</td>\n      <td>1919.75</td>\n      <td>302.00</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Female</td>\n      <td>Yes</td>\n      <td>593.27</td>\n      <td>96.74</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Female</td>\n      <td>No</td>\n      <td>977.68</td>\n      <td>149.77</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"      sex smoker  total_bill     tip\n0    Male    Yes     1337.07  183.07\n1    Male     No     1919.75  302.00\n2  Female    Yes      593.27   96.74\n3  Female     No      977.68  149.77"},"exec_count":25,"output_type":"execute_result"}},"pos":12,"type":"cell"}
{"cell_type":"code","exec_count":27,"id":"e75312","input":"# it can merge on partial column and index\npd.merge(\n    tips_bill.reset_index(), \n    tips_tip,\n    left_on=['sex', 'smoker'],\n    right_index=True\n)","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sex</th>\n      <th>smoker</th>\n      <th>total_bill</th>\n      <th>tip</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Male</td>\n      <td>Yes</td>\n      <td>1337.07</td>\n      <td>183.07</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Male</td>\n      <td>No</td>\n      <td>1919.75</td>\n      <td>302.00</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Female</td>\n      <td>Yes</td>\n      <td>593.27</td>\n      <td>96.74</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Female</td>\n      <td>No</td>\n      <td>977.68</td>\n      <td>149.77</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"      sex smoker  total_bill     tip\n0    Male    Yes     1337.07  183.07\n1    Male     No     1919.75  302.00\n2  Female    Yes      593.27   96.74\n3  Female     No      977.68  149.77"},"exec_count":27,"output_type":"execute_result"}},"pos":13,"type":"cell"}
{"cell_type":"code","exec_count":3,"id":"664633","input":"tips_bill = tips.groupby(['sex', 'smoker'])[['total_bill', 'tip']].sum()\ntips_tip = tips.groupby(['sex', 'smoker'])[['total_bill', 'tip']].sum()\n\ndel tips_bill['tip']\ndel tips_tip['total_bill']","pos":4,"type":"cell"}
{"cell_type":"code","exec_count":31,"id":"6cdc4b","input":"# we can do any SQL-like functionality\npd.merge(\n    tips_bill.reset_index(), \n    tips_tip.reset_index().head(2),\n    how='left'\n)","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sex</th>\n      <th>smoker</th>\n      <th>total_bill</th>\n      <th>tip</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Male</td>\n      <td>Yes</td>\n      <td>1337.07</td>\n      <td>183.07</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Male</td>\n      <td>No</td>\n      <td>1919.75</td>\n      <td>302.00</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Female</td>\n      <td>Yes</td>\n      <td>593.27</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Female</td>\n      <td>No</td>\n      <td>977.68</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"      sex smoker  total_bill     tip\n0    Male    Yes     1337.07  183.07\n1    Male     No     1919.75  302.00\n2  Female    Yes      593.27     NaN\n3  Female     No      977.68     NaN"},"exec_count":31,"output_type":"execute_result"}},"pos":16,"type":"cell"}
{"cell_type":"code","exec_count":32,"id":"df46bd","input":"pd.merge(\n    tips_bill.reset_index(), \n    tips_tip.reset_index().head(2),\n    how='inner'\n)","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sex</th>\n      <th>smoker</th>\n      <th>total_bill</th>\n      <th>tip</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Male</td>\n      <td>Yes</td>\n      <td>1337.07</td>\n      <td>183.07</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Male</td>\n      <td>No</td>\n      <td>1919.75</td>\n      <td>302.00</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"    sex smoker  total_bill     tip\n0  Male    Yes     1337.07  183.07\n1  Male     No     1919.75  302.00"},"exec_count":32,"output_type":"execute_result"}},"pos":17,"type":"cell"}
{"cell_type":"code","exec_count":35,"id":"4100ee","input":"# it can handle columns with the same name\npd.merge(tips_bill, \n         tips_bill, \n         right_index=True, \n         left_index=True,\n         suffixes=('_left', '_right')\n)","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>total_bill_left</th>\n      <th>total_bill_right</th>\n    </tr>\n    <tr>\n      <th>sex</th>\n      <th>smoker</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Male</th>\n      <th>Yes</th>\n      <td>1337.07</td>\n      <td>1337.07</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>1919.75</td>\n      <td>1919.75</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Female</th>\n      <th>Yes</th>\n      <td>593.27</td>\n      <td>593.27</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>977.68</td>\n      <td>977.68</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"               total_bill_left  total_bill_right\nsex    smoker                                   \nMale   Yes             1337.07           1337.07\n       No              1919.75           1919.75\nFemale Yes              593.27            593.27\n       No               977.68            977.68"},"exec_count":35,"output_type":"execute_result"}},"pos":19,"type":"cell"}
{"cell_type":"code","exec_count":36,"id":"fc90f4","input":"# and if you add an indicator...\npd.merge(\n    tips_bill.reset_index().tail(3), \n    tips_tip.reset_index().head(3),\n    how='outer',\n    indicator=True\n)","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sex</th>\n      <th>smoker</th>\n      <th>total_bill</th>\n      <th>tip</th>\n      <th>_merge</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Male</td>\n      <td>No</td>\n      <td>1919.75</td>\n      <td>302.00</td>\n      <td>both</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Female</td>\n      <td>Yes</td>\n      <td>593.27</td>\n      <td>96.74</td>\n      <td>both</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Female</td>\n      <td>No</td>\n      <td>977.68</td>\n      <td>NaN</td>\n      <td>left_only</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Male</td>\n      <td>Yes</td>\n      <td>NaN</td>\n      <td>183.07</td>\n      <td>right_only</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"      sex smoker  total_bill     tip      _merge\n0    Male     No     1919.75  302.00        both\n1  Female    Yes      593.27   96.74        both\n2  Female     No      977.68     NaN   left_only\n3    Male    Yes         NaN  183.07  right_only"},"exec_count":36,"output_type":"execute_result"}},"pos":18,"type":"cell"}
{"cell_type":"code","exec_count":4,"id":"5af00b","input":"tips_bill","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>total_bill</th>\n    </tr>\n    <tr>\n      <th>sex</th>\n      <th>smoker</th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Male</th>\n      <th>Yes</th>\n      <td>1337.07</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>1919.75</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Female</th>\n      <th>Yes</th>\n      <td>593.27</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>977.68</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"               total_bill\nsex    smoker            \nMale   Yes        1337.07\n       No         1919.75\nFemale Yes         593.27\n       No          977.68"},"exec_count":4,"output_type":"execute_result"}},"pos":5,"type":"cell"}
{"cell_type":"code","exec_count":5,"id":"254fc5","input":"#it can do interesting combinations\ntips_bill_strange = tips_bill.reset_index(level=0)\ntips_bill_strange","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sex</th>\n      <th>total_bill</th>\n    </tr>\n    <tr>\n      <th>smoker</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Yes</th>\n      <td>Male</td>\n      <td>1337.07</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>Male</td>\n      <td>1919.75</td>\n    </tr>\n    <tr>\n      <th>Yes</th>\n      <td>Female</td>\n      <td>593.27</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>Female</td>\n      <td>977.68</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"           sex  total_bill\nsmoker                    \nYes       Male     1337.07\nNo        Male     1919.75\nYes     Female      593.27\nNo      Female      977.68"},"exec_count":5,"output_type":"execute_result"}},"pos":14,"type":"cell"}
{"cell_type":"code","exec_count":7,"id":"0d9885","input":"pd.merge(\n    tips_tip.reset_index(), \n    tips_bill_strange,\n    on=['sex', 'smoker']\n)","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sex</th>\n      <th>smoker</th>\n      <th>tip</th>\n      <th>total_bill</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Male</td>\n      <td>Yes</td>\n      <td>183.07</td>\n      <td>1337.07</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Male</td>\n      <td>No</td>\n      <td>302.00</td>\n      <td>1919.75</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Female</td>\n      <td>Yes</td>\n      <td>96.74</td>\n      <td>593.27</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Female</td>\n      <td>No</td>\n      <td>149.77</td>\n      <td>977.68</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"      sex smoker     tip  total_bill\n0    Male    Yes  183.07     1337.07\n1    Male     No  302.00     1919.75\n2  Female    Yes   96.74      593.27\n3  Female     No  149.77      977.68"},"exec_count":7,"output_type":"execute_result"}},"pos":15,"type":"cell"}
{"cell_type":"code","exec_count":8,"id":"f1211e","input":"# this adds the dataframes together row wise\npd.concat([tips_bill, tips_bill, tips_tip], sort=False)","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>total_bill</th>\n      <th>tip</th>\n    </tr>\n    <tr>\n      <th>sex</th>\n      <th>smoker</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Male</th>\n      <th>Yes</th>\n      <td>1337.07</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>1919.75</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Female</th>\n      <th>Yes</th>\n      <td>593.27</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>977.68</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Male</th>\n      <th>Yes</th>\n      <td>1337.07</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>1919.75</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Female</th>\n      <th>Yes</th>\n      <td>593.27</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>977.68</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Male</th>\n      <th>Yes</th>\n      <td>NaN</td>\n      <td>183.07</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>NaN</td>\n      <td>302.00</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Female</th>\n      <th>Yes</th>\n      <td>NaN</td>\n      <td>96.74</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>NaN</td>\n      <td>149.77</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"               total_bill     tip\nsex    smoker                    \nMale   Yes        1337.07     NaN\n       No         1919.75     NaN\nFemale Yes         593.27     NaN\n       No          977.68     NaN\nMale   Yes        1337.07     NaN\n       No         1919.75     NaN\nFemale Yes         593.27     NaN\n       No          977.68     NaN\nMale   Yes            NaN  183.07\n       No             NaN  302.00\nFemale Yes            NaN   96.74\n       No             NaN  149.77"},"exec_count":8,"output_type":"execute_result"}},"pos":22,"type":"cell"}
{"cell_type":"code","exec_count":9,"id":"98cb53","input":"# this does it column wise\npd.concat([tips_bill, tips_tip], axis=1)","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>total_bill</th>\n      <th>tip</th>\n    </tr>\n    <tr>\n      <th>sex</th>\n      <th>smoker</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Male</th>\n      <th>Yes</th>\n      <td>1337.07</td>\n      <td>183.07</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>1919.75</td>\n      <td>302.00</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">Female</th>\n      <th>Yes</th>\n      <td>593.27</td>\n      <td>96.74</td>\n    </tr>\n    <tr>\n      <th>No</th>\n      <td>977.68</td>\n      <td>149.77</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"               total_bill     tip\nsex    smoker                    \nMale   Yes        1337.07  183.07\n       No         1919.75  302.00\nFemale Yes         593.27   96.74\n       No          977.68  149.77"},"exec_count":9,"output_type":"execute_result"}},"pos":23,"type":"cell"}
{"cell_type":"code","id":"edbf58","input":"","pos":27,"type":"cell"}
{"cell_type":"markdown","id":"3ea7d5","input":"# Contatenation\n\nConcatenating is for combining more than two dataframes in either column-wise or row-wise. The problem with concatenate is that the combinations it allows you to do are rather simplistic. That's why we need merge. \n\nConcatenate can take as many data frames as you want, but it requires that they are specifically constructed. All of the dataframes you pass in will need to have the same index. So no more using columns as an index. \n\nLet's check out basic use below:","pos":21,"type":"cell"}
{"cell_type":"markdown","id":"447016","input":"Notice that there are a ton of options:","pos":9,"type":"cell"}
{"cell_type":"markdown","id":"7950b0","input":"This is one of the most complex parts of pandas - but it is very important to master. So please do check out the excerises below!\n\nOne thing to be careful with here is merging two data types. Strings are not equal to ints!","pos":20,"type":"cell"}
{"cell_type":"markdown","id":"b52684","input":"## Conclusion\n\nThere are a couple of other ways to merge data, but they are pretty niche (and mainly for time series data). If y'all have a desire for me to go over them then comment below!\n\nThey are:\n\n* combine_first\n* merge_ordered\n* merge_asof\n\nOtherwise you should be fully equipped to do the [exercises](https://github.com/guipsamora/pandas_exercises#merge). These functions require a bit of practice to get used to, so don't be discouraged if it takes some time.","pos":26,"type":"cell"}
{"cell_type":"markdown","id":"c25bc1","input":"## Merge\n\nMerging is for doing complex column-wise combinations of dataframes in a SQL-like way. If you don't know SQL joins then check out this resource [sql joins](https://www.w3schools.com/sql/sql_join.asp) and comment below (and maybe I'll make a video). \n\nTwo merge we need two dataframes, let's make them below:","pos":3,"type":"cell"}
{"cell_type":"markdown","id":"c26c6d","input":"Now that we have two datasets that we want to combine (aka take the tips and combine with the total bill), how do we do it? We merge!","pos":7,"type":"cell"}
{"cell_type":"markdown","id":"c5769f","input":"# Pandas Combining DataFrames\n\nIn pandas there are 4 (plus a few special case) ways to combine data from different frames:\n\n* Merging\n* Joining\n* Concatenating \n* Appending\n\nWhere merging and joining are basically redundant and concatenating and appending are basically redundant. \n\nSo today we will be going over Merging and Concatenating in pandas. \n\nCheck out the full documentation [here](http://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html), but be warned it is a bit long :)\n\n\nOkay let's get started.","pos":1,"type":"cell"}
{"cell_type":"markdown","id":"de59f6","input":"As you can see there is not a ton of functionality to concat, but it is invaluable if you have more than one dataframe or you are looking to append the rows of one dataframe onto another.","pos":25,"type":"cell"}
{"id":0,"time":1598719134778,"type":"user"}
{"last_load":1598719116726,"type":"file"}